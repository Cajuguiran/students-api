<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../css/customs.css">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <title>Students-API</title>
</head>
<body onload="get_record()">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <div class="card  animated bounceInDown myForm">
        <div class="card-header p-3">
          <h5 class="mb-0"><i class="fas fa-tasks me-2"></i> Student List</h5>
        </div>
            <table class="table mb-0">
                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Firstname</th>
                        <th scope="col">Lastname</th>
                        <th scope="col">Middle</th>
                        <th scope="col">Address</th>
                        <th scope="col">Email</th>
                        <th scope="col">Course</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                    <tbody id="datas">
                        
                    </tbody>
            </table>    
    </div>
    <br>
    
        <form action="index.html" method="post" id="posts" class="decor">            
            <div class="container h-100">
                <div class="d-flex justify-content-center">
                    <div class="card col-md-4 animated bounceInDown myForm">
                        <div class="card-header">
                            <h4>Student Form</h4>
                        </div>
                        <div class="card-body">
                            <form>
                                <div id="dynamic_container">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fa-solid fa-users"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="firstname" placeholder="Firstname" required="required">
                                    </div>
                                    <div class="input-group mt-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fa-solid fa-users"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="lastname" placeholder="Lastname">
                                    </div>
                                    <div class="input-group mt-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fa-solid fa-users"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="middle" placeholder="Middle">
                                    </div>
                                    <div class="input-group mt-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fa-solid fa-location-dot"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="address" placeholder="Address">
                                    </div>
                                    <div class="input-group mt-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fas fa-at"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="email" placeholder="Email">
                                    </div>
                                    <div class="input-group mt-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text br-15"><i class="fa-solid fa-graduation-cap"></i></span>
                                        </div>
                                        <input type="text" class="form-control" name="course" placeholder="Course">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-success btn-sm float-right submit_btn text-end"><i class="fas fa-arrow-alt-circle-right"></i> Submit</button>
                        </div>
                    </div>
                </div>
                </div>
        </form>
    

        <form action="index.html" method="post" id="updates">
            <div class="modal fade" id="orangeModalSubscription" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-notify modal-warning" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title font-weight-bold py-2">Update</h4>
                            <br>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true" class="white-text">&times;</span> </button>
                        </div>
                        <div class="modal-body">
                            <div class="md-form mb-5">
                                <label for="form1">ID</label>
                                <input type="text" id="form1" name="id" class="form-control validate" value="" readonly> </div>
                            <div class="md-form">
                                <label for="form2">Firstname</label>
                                <input type="text" id="form2" name="firstname" class="form-control validate" value=""> </div>
                            <div class="md-form">
                                <label for="form2">Lastname</label>
                                <input type="text" id="form3" name="lastname" class="form-control validate"> </div>
                            <div class="md-form">
                                <label for="form2">Middle</label>
                                <input type="text" id="form4" name="middle" class="form-control validate" value=""> </div>
                            <div class="md-form">
                                <label for="form2">Address</label>
                                <input type="text" id="form5" name="address" class="form-control validate"> </div>    
                            <div class="md-form">
                                <label for="form2">Email</label>
                                <input type="text" id="form6" name="email" class="form-control validate" value=""> </div>
                            <div class="md-form">
                                <label for="form2">Course</label>
                                <input type="text" id="form7" name="course" class="form-control validate"> </div>
                        </div>
                        <div class="card-footer text-end p-3">
                            <button type="submit" class="btn btn-success btn-lg btn-block">Update</button>
                            <button data-dismiss="modal" class="btn btn-danger btn-lg btn-block">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <form action="index.html" method="post" id="deletes">
            <div class="modal fade" id="orangeModalSubscriptions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-notify modal-warning" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title font-weight-bold py-2">Delete?</h4>
                            <br>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true" class="white-text">&times;</span> </button>
                        </div>
                        <div class="modal-body">
                            <div class="md-form mb-5">
                                <label for="form1">ID</label>
                                <input type="text" id="form8" name="id" class="form-control validate" readonly> </div>
                            <div class="md-form">
                                <label for="form2">Firstname</label>
                                <input type="text" id="form9" name="firstname" class="form-control validate" disabled> </div>
                            <div class="md-form">
                                <label for="form2">Lastname</label>
                                <input type="text" id="form10" name="lastname" class="form-control validate" disabled> </div>
                            <div class="md-form">
                                <label for="form2">Middle</label>
                                <input type="text" id="form11" name="middle" class="form-control validate" disabled> </div>
                            <div class="md-form">
                                <label for="form2">Address</label>
                                <input type="text" id="form12" name="address" class="form-control validate" disabled> </div>
                            <div class="md-form">
                                <label for="form2">Email</label>
                                <input type="text" id="form13" name="email" class="form-control validate" disabled> </div>
                            <div class="md-form">
                                <label for="form2">Course</label>
                                <input type="text" id="form14" name="course" class="form-control validate" disabled> </div>
                        </div>
                        <div class="card-footer text-end p-3">
                            <button type="submit" class="btn btn-success btn-lg btn-block">Yes</button>
                            <button data-dismiss="modal" class="btn btn-danger btn-lg btn-block">No</button>
                        </div>
                    </div>
                </div>
            </div>
            
        </form>

    <script>
        

        txt = "";
        function get_record() {
            $.ajax({
                url: "http://students-api.test/student-php/",
                method: "GET",
                success: function(response) {
                    txt = "";
                    for(i=0;i<response.length;i++){
                        txt += `    
                        <tr>
                            <td id="${response[i].id}">${response[i].id}</td>
                            <td>${response[i].firstname}</td>
                            <td>${response[i].lastname}</td>
                            <td>${response[i].middle}</td>
                            <td>${response[i].address}</td>
                            <td>${response[i].email}</td>
                            <td>${response[i].course}</td>
                            <td>
                                <a href="#" class="edit" data-toggle="modal" data-target="#orangeModalSubscription"><i class="fa-solid fa-pen-to-square"></i></a>
                                <a href="#" class="delete" data-toggle="modal" data-target="#orangeModalSubscriptions"><i class="fas fa-trash-alt text-danger"></i></i></a>
                            </td>
                        </tr>
                        `;
                    }
                    document.getElementById("datas").innerHTML = txt;
                    var table = document.getElementById('datas'),rIndex;
                    for(i=0;i < table.rows.length;i++){
                        table.rows[i].onclick = function(){
                            rIndex = this.rowIndex;
                            document.getElementById('form1').value = this.cells[0].innerHTML;
                            document.getElementById('form2').value = this.cells[1].innerHTML;
                            document.getElementById('form3').value = this.cells[2].innerHTML;
                            document.getElementById('form4').value = this.cells[3].innerHTML;
                            document.getElementById('form5').value = this.cells[4].innerHTML;
                            document.getElementById('form6').value = this.cells[5].innerHTML;
                            document.getElementById('form7').value = this.cells[6].innerHTML;
                            document.getElementById('form8').value = this.cells[0].innerHTML;
                            document.getElementById('form9').value = this.cells[1].innerHTML;
                            document.getElementById('form10').value = this.cells[2].innerHTML;
                            document.getElementById('form11').value = this.cells[3].innerHTML;
                            document.getElementById('form12').value = this.cells[4].innerHTML;
                            document.getElementById('form13').value = this.cells[5].innerHTML;
                            document.getElementById('form14').value = this.cells[6].innerHTML;
                        }
                    }
                },
                error: function(xhr, status, error) {
                    var err = eval("(" + xhr.responseText + ")");                    
                    console.log(err.Message);
                }
            });
        }

        $("form#posts").submit(function(){
            var formData = $(this).serialize();
            console.log(formData);
            $.ajax({
                url: "http://students-api.test/student-php/",
                method: "POST",
                data:formData,
                success: function(response) {
                    console.log(response)
                },
                error: function(xhr, status, error) {
                    var err = eval("(" + xhr.responseText + ")");                    
                    console.log(err.Message);
                }
            });
            get_record();
        });
    
        $("form#updates").submit(function(){
            var formData = $(this).serialize();
            console.log(formData);
            $.ajax({
                url: "http://students-api.test/student-php/",
                method: "PUT",
                data:formData,
                success: function(response) {
                    console.log(response)
                },
                error: function(xhr, status, error) {
                    var err = eval("(" + xhr.responseText + ")");                    
                    console.log(err.Message);
                }
            });
            get_record();
        });
        
        $("form#deletes").submit(function(){
            var formData = $(this).serialize();
            console.log(formData);
            $.ajax({
                url: "http://students-api.test/student-php/",
                method: "DELETE",
                data:formData,
                success: function(response) {
                    console.log(response)
                },
                error: function(xhr, status, error) {
                    var err = eval("(" + xhr.responseText + ")");                    
                    console.log(err.Message);
                }
            });
            get_record();
        });
    </script>
</body>
</html>